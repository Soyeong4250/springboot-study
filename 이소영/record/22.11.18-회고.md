# 22.11.18 íšŒê³ 

### âœ… ë°œìƒí•œ ì—ëŸ¬

![image-20221121222028581](./assets/image-20221121222028581.png)

![image-20221121215946130](./assets/image-20221121215946130.png)

ê²Œì‹œê¸€ ì‘ì„±í•˜ê¸° ê¸°ëŠ¥ êµ¬í˜„ ì¤‘ RequestDto ê°ì²´ì— ë°ì´í„°ê°€ ì˜¨ì „íˆ ë‹´ê¸°ì§€ ì•Šê³  nullë¡œ ë„˜ì–´ì˜¤ëŠ” ê²ƒì„ í™•ì¸

![image-20221121222148253](./assets/image-20221121222148253.png)

DB ì—­ì‹œ AutoIncreament ì„¤ì •ì´ ë˜ì–´ìˆëŠ” id ì™¸ì˜ ì»¬ëŸ¼ë“¤ì— ëª¨ë‘ null ê°’ì´ ë“¤ì–´ê°”ìŒì„ í™•ì¸

<br />

<br />

### ğŸ’¡ í•´ê²° ê³¼ì •

#### 1ï¸âƒ£ ì²« ë²ˆì§¸ ì‹œë„

ArticleControllerì˜ register()ì˜ ë§¤ê°œë³€ìˆ˜ì— `@RequestBody` ì„ ì–¸

**ğŸ‘‡ ArticleController.java**

```Java
package com.springboot.api.controller;

import com.springboot.api.domain.dto.ArticleRequestDto;
import com.springboot.api.domain.entity.Article;
import com.springboot.api.repository.ArticleRepository;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@Slf4j
@RequestMapping("/articles")
public class ArticleController {

    private final ArticleRepository articleRepository;

    public ArticleController(ArticleRepository articleRepository) {
        this.articleRepository = articleRepository;
    }

    @GetMapping("/new")
    public String registerPage() {
        return "articles/register";
    }

    @PostMapping()
    public String register(@RequestBody ArticleRequestDto articleRequestDto) {
        log.info(articleRequestDto.toString());
        Article savedArticle = articleRepository.save(articleRequestDto.toEntity());
        log.info("generatedId : {}", savedArticle.getId());
        return "";
    }
}
```

**ğŸ‘‡ register.mustache **

```html
{{> layouts/header}}
<div id="wrapper" class="container mt-3">
    <div id="pageTitle">
        <h1>ê²Œì‹œê¸€ ì‘ì„±í•˜ê¸°</h1>
    </div>
    <form class="mt-3" action="/articles" method="post">
        <div class="form-group mb-3">
            <label for="titleInput" class="form-label">Title</label>
            <input type="text" class="form-control" name="title" id="title" placeholder="ì œëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.">
        </div>
        <div class="form-group mb-3">
            <label for="writerInput" class="form-label">Title</label>
            <input type="text" class="form-control" name="writer" id="writer" placeholder="ì‘ì„±ìë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.">
        </div>
        <div class="form-group mb-3">
            <label for="contentInput" class="form-label">Content</label>
            <textarea class="form-control" id="content" name="content" rows="20" placeholder="ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”."></textarea>
        </div>
        <div class="d-flex justify-content-end">
            <button class="btn btn-outline-danger me-3" onclick="href='#'">Back</button>
            <button type="submit" class="btn btn-outline-primary">Write</button>
        </div>
    </form>
</div>
{{> layouts/footer}}
```



#### ğŸ˜¡ ì‹¤í–‰ ê²°ê³¼ 

![image-20221121220909652](./assets/image-20221121220909652.png)

<mark style="color:red;">Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'application/x-www-form-urlencoded;charset=UTF-8' not supported]</mark> ì—ëŸ¬ ë°œìƒ

<br />

<br />

#### 2ï¸âƒ£ ë‘ ë²ˆì§¸ ì‹œë„

ArticleRequestDtoì— `@Setter` ì„ ì–¸

**ğŸ‘‡ ArticelRequestDto.java**

```Java
package com.springboot.api.domain.dto;

import com.springboot.api.domain.entity.Article;
import lombok.*;

@Getter
@Setter
@NoArgsConstructor
@ToString
public class ArticleRequestDto {
    private String title;
    private String content;
    private String writer;

    public ArticleRequestDto(String title, String content, String writer) {
        this.title = title;
        this.content = content;
        this.writer = writer;
    }

    public Article toEntity() {
        return new Article(this.title, this.content, this.writer);
    }
}
```

**ğŸ‘‡ ArticleController.java**

```java
package com.springboot.api.controller;

import com.springboot.api.domain.dto.ArticleRequestDto;
import com.springboot.api.domain.entity.Article;
import com.springboot.api.repository.ArticleRepository;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@Slf4j
@RequestMapping("/articles")
public class ArticleController {

    private final ArticleRepository articleRepository;

    public ArticleController(ArticleRepository articleRepository) {
        this.articleRepository = articleRepository;
    }

    @GetMapping("/new")
    public String registerPage() {
        return "articles/register";
    }

    @PostMapping()
    public String register(ArticleRequestDto articleRequestDto) {
        log.info(articleRequestDto.toString());
        Article savedArticle = articleRepository.save(articleRequestDto.toEntity());
        log.info("generatedId : {}", savedArticle.getId());
        return "redirect:articles/list";
    }
}
```



#### ğŸ˜Š ì‹¤í–‰ ê²°ê³¼

![image-20221121222505649](./assets/image-20221121222505649.png)

ArticleRequestDtoì— ëª¨ë“  ê°’ì´ ì˜ ë‹´ê¸°ëŠ” ê²ƒì„ í™•ì¸

![image-20221121222558214](./assets/image-20221121222558214.png)

DB ì—­ì‹œ ê°’ì´ ëª¨ë‘ ì˜ ë‹´ê¸°ëŠ” ê²ƒì„ í™•ì¸